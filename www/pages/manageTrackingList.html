<div id="manageTripPage" data-role="page" data-theme="a">
<script>
		$(document).on("click", ".show-page-loading-msg", function() {
			var $this = $( this ),
				theme = $this.jqmData("theme") || $.mobile.loader.prototype.options.theme,
				msgText = $this.jqmData("msgtext") || $.mobile.loader.prototype.options.text,
				textVisible = $this.jqmData("textvisible") || $.mobile.loader.prototype.options.textVisible,
				textonly = !!$this.jqmData("textonly");
				html = $this.jqmData("html") || "";
			$.mobile.loading( 'show', {
					text: msgText,
					textVisible: textVisible,
					theme: theme,
					textonly: textonly,
					html: html
			});
			
		})
		.on("click", ".hide-page-loading-msg", function() {
			$.mobile.loading( 'hide' );
		});
</script>

  <script>

var timeStr = function(time) {

	var zeroPad = function(str, n) {
		var l = String(str).length;
		if(l < n) {
			return Array(n - l + 1).join("0") + str;
		}
		return str;
	}
	
	var timestr = new Date(time);
	var hour = timestr.getHours();
	var minute = timestr.getMinutes();
	var str = (zeroPad(hour, 2) + ":" + zeroPad(minute, 2));
	
	return str;
};

		

// Add history
$(document).one("pagebeforeshow", function() {

	var elem = $('#manageTrackingList');
	var entry = app.session.getLocalLog(app.session.getActiveLogId());
	var log = entry.log;
	var synched = entry.synched;
	
	if(synched) {
		$('#uploadBtn').text("Already uploaded");
		//$('#uploadBtn').button();
		//$('#uploadBtn').button("disable");
	}
	
	elem.listview();
	
	for(var i = 0; i < log.modes.length; i++) {
		
		var time = log.modes[i].time;
		var mode = log.modes[i].mode;
		
		if(mode <= 0)
			continue;
		
		var modestr = Logger.MODE[mode];
		
		elem.append("<li>\
				<a href=\"#\">\
				  <h1>" + timeStr(time) + "</h1>\
				  <div class=\"ui-li-aside\"><img src=\"../images/" + modestr + ".png\" /></div>\
				</a>\
				<!--<a data-role=\"button\">Change</a>-->\
			</li>"
		);
		
	}
	
	elem.listview('refresh');

});

</script>


    <div data-role="header" data-theme="a">
        	<a href="history.html" data-theme="a" class="back" data-icon="arrow-l">Back</a>
         	<p>Tracking</p>
            <a href="#" id="mapIcon" data-role="button" data-inline="true" class="customButton">
    			<img src="../images/mapIcon.png"/>
    		</a> 
    </div>
        
    <div data-role="content">
    	<div id="manageTripButtons">
                      
                <div id="saveDeleteButtons" data-role="controlgroup" data-type="horizontal">
                     <a data-role="button" data-theme="a" onclick="" id="saveChanges">Save changes</a>
                     <a data-role="button" data-theme="d" onclick="app.uploadTrip(app.session.getActiveLogId());" id="uploadBtn">Upload</a>
                     <a data-role="button" data-theme="a" onclick="app.deleteTrip(app.session.getActiveLogId())" id="deleteTrip">Delete</a>
                </div>
                    
        </div>
                
		<ul id="manageTrackingList" class="trackingList" data-icon="" data-role="listview" data-inset="true" data-theme="a">
            
              
                
               <!-- 
                <li>
                    <a href="#">
                      <p>Trip1</p>
                      <h1>11:34 - 11:59</h1>
                      <div class="ui-li-aside"><img src="../images/walk.png"/></div>
                    </a>
                    <a data-role="button">Change</a>
                </li>
                <li>
                    <a href="#">
                      <p>Trip2</p>
                      <h1>12:03 - 12:21</h1>
                      <div class="ui-li-aside"><img src="../images/buss.png"/></div>
                    </a>
                    <a data-role="button">Change</a>
                </li>
                <li>
                    <a>
                      <p>Trip3</p>
                      <h1>12:22 - 12:40</h1>
                      <div class="ui-li-aside"><img src="../images/tram.png"/></div>
                    </a>
                    <a data-role="button">Change</a>
                </li>
            -->
                
		</ul>
              
        <div id="map">
        </div>
                <!--
                <div id="popupMode">
                <a data-rel="popup" data-role="button"href="#popupTranspMode">OK</a>
                
                <div data-role="popup" id="popupTranspMode" class="popupDialog" data-overlay-theme="a" data-theme="c" style="max-width:400px;" class="ui-corner-all" data-position-to="window"> 
                    <div data-role="header" data-theme="a" class="ui-corner-top">
                        <h1>Change mode</h1>
                    </div>
                    <div data-role="content" data-theme="a" class="ui-corner-bottom ui-content">
                        <div id="selectMode" style="width: 100%;">
                            <select name="tripMode" id="tripMode">
                                <option value="0">Travel mode?</option>
                                <option value="1">Bus</option>
                                <option value="2">Tram</option>
                                <option value="3">Subway</option>
                                <option value="4">Walk</option>
                                <option value="5">Bicycle</option>
                                <option value="6">Boat</option>
                                <option value="7">Car</option>
                              </select>
                         </div>
                        <div id="dialogButtons">    
                            <a href="#" data-role="button" data-inline="true" data-rel="back" data-transition="flow" data-theme="d">OK</a> 
                        </div> 
                    </div>
                </div>
				</div>-->
            
    </div>
        
    <div id="mainmenu" data-role="footer" data-position="fixed" data-theme="a">
          <div id="menuButtons"data-inline="true" data-type="horizontal">
              <a href="userinfo.html" data-role="button" data-inline="true"><img src="../images/person2.png"/></a>
              <a href="tracking.html" data-role="button" data-inline="true"><img src="../images/tracking2selected.png"/></a>
              <a href="history.html" data-role="button" data-inline="true"><img src="../images/book2.png"/></a>
              <a href="#" data-role="button" data-inline="true"><img src="../images/achievements2.png"/></a>
          </div>
    	
    </div>
        
</div>

<div id="mapPage" data-role="page">
	<div id="mapView">
    <img src="../images/map.png"/>
    </div>
</div>