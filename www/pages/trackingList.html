<div data-role="page" data-theme="a">

  <script>

var timeStr = function(time) {

	var zeroPad = function(str, n) {
		var l = String(str).length;
		if(l < n) {
			return Array(n - l + 1).join("0") + str;
		}
		return str;
	}
	
	var timestr = new Date(time);
	var hour = timestr.getHours();
	var minute = timestr.getMinutes();
	var str = (zeroPad(hour, 2) + ":" + zeroPad(minute, 2));
	
	return str;
};

		

// Add history
$(document).one("pagebeforeshow", function() {

	var elem = $('#trackingList');
	var log = app.log;
	
	elem.listview();
	
	for(var i = 0; i < log.modes.length; i++) {
		
		var time = log.modes[i].time;
		var mode = log.modes[i].mode;
		
		if(mode <= 0)
			continue;
		
		var modestr = Logger.MODE[mode];
		
		elem.append("<li>\
				<a href=\"#\">\
				  <h1>" + timeStr(time) + "</h1>\
				  <div class=\"ui-li-aside\"><img src=\"../images/" + modestr + ".png\" /></div>\
				</a>\
				<!--<a data-role=\"button\">Change</a>-->\
			</li>"
		);
		
	}
	
	elem.listview('refresh');

});

</script>

    	<div data-role="header" data-theme="a">
         <p>Tracking</p>
        </div>
        
        <div data-role="content" data-theme="a">
        
          <ul id="trackingList" class="trackingList" data-role="listview" data-inset="true">
          	<li>
            	<div id="time"><script>$('#time').html("Finished at " + (new Date).toLocaleTimeString());</script></div>
            </li>
            <!--
            <li>
            	<a href="#">
                  <p>Trip1</p>
                  <h1>11:34 - 11:59</h1>
                  <div class="ui-li-aside"><img src="../images/walk.png"/></div>
            	</a>
                <a data-role="button">Change</a>
         	</li>
            <li>
            	<a href="#">
                  <p>Trip2</p>
                  <h1>12:03 - 12:21</h1>
                  <div class="ui-li-aside"><img src="../images/buss.png"/></div>
            	</a>
                <a data-role="button">Change</a>
       		</li>
            <li>
            	<a>
                  <p>Trip3</p>
                  <h1>12:22 - 12:40</h1>
                  <div class="ui-li-aside"><img src="../images/tram.png"/></div>
            	</a>
                <a data-role="button">Change</a>
            </li>
            -->
            <li id="buttons">
            	<div id="uploadDeleteButtons" data-role="controlgroup" data-type="horizontal">
                    <a data-role="button" data-theme="f" onclick="app.receivedEvent('savetrip');" id="save">Save</a>
                    <a data-role="button" data-theme="d" onclick="app.receivedEvent('uploadtrip');" id="upload">Upload</a>
                    <a data-role="button" data-theme="f" onclick="app.receivedEvent('discardtrip');" id="delete">Discard</a>
          		</div>
            </li>
          </ul>
          
         	<div id="map">
        	</div>
            
        </div>
        
        <div id="mainmenu" data-role="footer" data-position="fixed" data-theme="a">
          <div id="menuButtons"data-inline="true" data-type="horizontal">
              <a href="userinfo.html" data-role="button" data-inline="true"><img src="../images/person2.png"/></a>
              <a href="tracking.html" data-role="button" data-inline="true"><img src="../images/tracking2selected.png"/></a>
              <a href="history.html" data-role="button" data-inline="true"><img src="../images/book2.png"/></a>
              <a href="#" data-role="button" data-inline="true"><img src="../images/achievements2.png"/></a>
          </div>
    	
    	</div>
        
</div>

<div id="mapPage" data-role="page">
	<div id="mapView">
    <img src="../images/map.png"/>
    </div>
</div>